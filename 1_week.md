# 머신러닝 분류 모델의 성능 평가 지표  


### 모델 성능 평가  
- 실제 값과 모델에 의해 예측된 값을 비교하여 두 값의 차이(오차)를 구하는 것
- 실제값 - 예측값 = 0이 되면 오차가 없는 것으로, 모델이 값을 100% 잘 맞웠다고 생각하면 된다.
- 하지만 예측값이 실제값과 100% 일치하는 것은 어렵기 때문에, 오차를 어느 정도가지 허용할지 결정하게 된다.  
- 모델 평가는 과적합(Overfitting)을 방지하고 최적의 모델을 찾기 위해서 실시한다.
- 결과변수(답안지)가 있어야 잘한건지 아닌지 확인할 수 있기 때문에 지도학습에서만 사용할 수 있다.
- 모델링의 목적 또는 목표 변수의 유형에 따라 다른 평가지표를 사용한다.
- Training과 Validation 값이 거의 일치해야 좋은 모델이다. 만약 Training 데이터로는 성능이 좋게 나왔는데 Validatin 데이터에서는 성능이 확연하게 떨어진다면 모델이 과적합된 상태이다.  

### 분류 모델 성능 평가  
- 하나의 목표를 가지고 여러 가지 분류 모델을 만드는 경우가 있는데, 그 중 어떤 모델이 가장 나을지 판단할 때 이러한 모델 평가 지표를 사용하게 된다.  
- 분류 모델의 평가 방법도 회귀 모형과 비슷하게, 실제 데이터와 예측 결과 데이터가 얼마나 서로 비슷한지에 기반하지만, 단순하게 이것만을 가지고 판단할 수는 없다.
- 분류 모델의 성능을 평가하기 위해 다음과 같은 지표를 활용한다.  
1. 정확도 (Accuracy)  
2. 오차 행렬 (Confusion Matrix)
3. 정밀도 (Precision)
4. 재현율 (Recall)
5. F1-score
6. ROC-AUC  
***
1. 정밀도 (Precision)   
- 정밀도는 '양성으로 판단한 것 중, 진짜 양성의 비율'이다.
```
정밀도 = TP / TP + FP   
```

2. 재현율 (Recall) = 민감도 (Sensitivity)  
- '진짜 양성인 것들 중에서 올바르게 양성으로 판단한 비율'이다.  
- 양성 결과를 정확히 예측하는 능력으로, 모델의 완전성을 평가하는 지표로 사용된다.  
```
재현율 = TP / TP + FN
```

정밀도와 재현율은 Positive 데이터 세트의 예측 성능에 좀 더 초점을 맞춘 평가 지표이며, 이진 분류 모델의 업무 특성에 따라 특정 평가 지표가 더 중요한 지표로 간주될 수 있다.  
예를 들어 재현율은 실제 Positive(양성)인 데이터 예측을 Negative(음성)로 잘못 판단하게 되면 업무 상 큰 영향이 발생하는 경우 더 중요한 지표로 간주되고, 정밀도는 실제  Negative(음성)인 데이터를 Positive(양성)로 잘못 판단하게 되었을 때 큰 문제가 발생되는 경우 더 중요한 지표로 간주된다.

재현율과 정밀도 모두 TP(True Positive)를 높이는데 초점을 맞추지만, 재현율은 FN(실제 Positive한 것을 Negative로 예측)한 것을 낮추는데, 정밀도는 FP를 낮추는데 초점을 맞춘다.  
이와 같은 특성 때문에 재현율과 정밀도는 서로 보완적인 지표로 분류 성능을 평가하는데 사용되는데, 이때 어느 한쪽을 강제로 높이면 다른 하나의 수치는 떨어지기 쉬워진다.  
이를 정밀도와 재현율은 트레이트 오프(Trade-off)관계에 있다고 한다.

3. mAP  
합성곱 신경망 (Convolutional Neural Network CNN)의 모델 성능 평가는 대체로 mAP을 이용하여 평가한다.  
mAP을 이해하기 위해서는 먼저 IoU와 AP에 대해 이해해야 한다.

3.1. IoU (Intersect over Union)  
객체 탐지 모델에서 "물체를 옳게 검출했다.", "물체가 옳게 검출되지 않았다."를 구분하는 기준을 의미한다.  
사용자가 인물의 위치에 적용한 바운더리 박스와 바운더리 박스가 주어지지 않은 상황에서 어떤 모델이 예측한 바운더리 박스라고 가정해보자.  
이때 모델이 설정한 바운더리 박스가 맞는지 틀린 지를 결정하기 위해서 나온 것이 IoU이다.  
![image](https://user-images.githubusercontent.com/120306359/224624163-6fc94510-1c0f-429b-a7cf-2a18dd6b9803.png)  
IoU는 다음 그림과 같이 구할 수 있다. 예측된 바운더리 박스와 사용자가 설정한 바운더리 박스 간 중첩되는 부분의 면적을 측정하여 중첩된 면적을 합집합의 면적으로 나워준다. 
보통 결과 값이 0.5이상이면 제대로 검출(TF)되었다고 판단한다. 만약 0.5미만이면 잘못 검출(FP)되었다고 판단한다. (이 값은 임의의 값으로 설정할 수 있다.)  

3.2. Precision-recall 곡선  
Precision-recall 곡선(PR 곡선)은 물체를 검출하는 알고리즘의 성능을 평가하는 방법 중 하나로 confidence 레벨에 대한 threshold 값의 변화에 따라 precision과 recall 값들도 달라진다.  
confidence는 검출한 것에 대해 모델이 얼마나 정확하다고 생각하는 지 알려주는 값이다. 만약 어떤 물체를 검출했을 때 confidence 레벨이 0.99라면 모델은 그 물체가 검출해야 하는 물체와 거의 똑같다고 생각하는 것과 같다. 하지만 confidence 레벨이 높다고 해서 무조건 정확한 것은 아니다. 모델이 그저 학습한 것에 따른 정확도를 나타내는 것이다.  
사용자는 보통 confidence 레벨에 대해 threshold 값을 부여하여 특정 값 이상이 되어야 검출된 것으로 인정한다. 따라서 threshold 값의 변화에 따라 precision과 recall의 값들도 달라질 것이다. 이것을 그래프로 나타낸 것이 바로 PR 곡선이다.  
PR 곡선에서 x축은 Recall 값이고, y축은 Precision 값이다. 즉, PR 곡선에서는 Recall 값의 변화에 따른 Precision 값을 확인할 수 있다.  

3.3. AP (Average Precision)와 mAP  
PR 그래프는 어떤 모델의 성능을 전반적으로 파악하기에는 좋으나 서로 다른 두 모델의 성능을 정량적으로 비교하기에는 불편한 점이 있다. 그래서 나온 개념이 AP이다. AP는 인식 알고리즘의 성능을 하나의 값으로 표현한 것으로서 PR 그래프에서 그래프 선 아래쪽의 면적으로 계산된다. AP가 높으면 높을수록 그 모델의 성능이 전체적으로 우수하다는 의미이다.  
컴퓨터 비전 분야에서 물체 검출 및 이미지 분류 모델의 성능은 대부분 AP로 평가한다. 물체 클래스가 여러 개인 경우 각 클래스 당 AP를 구한 다음에 그것을 모두 합한 후 물체 클래스 갯수로 나눠줌으로서 모델의 성능을 평가한다. 이것을 mAP (mean Average Precision)라고 한다.

4. NMS  
Network Management System으로 네트워크 관리 시스템이라고 하며, 컴퓨터 네트워크 또는 네트워크들을 모니터링하고 관리하는데 사용되는 하드웨어와 소프트웨어의 조합을 총칭한다.  
예를 들어 네트워크가 문제 없이 작동하고 있는지 검사하는 것이나 서버 컴퓨터나 기타 장비들의 이상 유무 등 전반적인 관리를 전부 포함하는 것이다. 이러한 문제점들을 점검하고 모니터링 한 후 사후 조치나 관리까지 총괄하는 일을 말한다.  

NMS의 5대 기능(FCAPS)
- 결함 관리(Fault Management) : 결함을 탐지하고 사용자에게 알려 신속하게 결함을 해결하는 일
- 회계 관리(Accounting Management) : 사용자의 네트워크 자원의 사용 비용을 알려주고 측정하는 일
- 구성 관리(Configuration Management) : 네트워크 통신망을 구성하고 있는 통신 장비, 프로그램 등에 대해서 위치 혹은 구성 정보, 장치 수량 등을 파악하여 관리하고 경우에 맞게 재구성하는 일
- 성능 관리(Performance Management) : 네트워크 운용에 관한 통계의 수집 및 분석을 통하여 향후 수요 예측과 네트워크 운용의 최적화 등을 관리하는 일
- 보안 관리(Security Management) : 통신망과 통신 장비에 대한 접근 제어와 보안 서비스 등을 관리하는 일  

NMS의 기능별 분류
- 플랫폼 NMS : 네트워크 플랫폼 역할을 수행하면서 새로운 프로젝트 진행 가능 (서버 및 소프트웨어 제조업체 공급)
* 단점 : 보고서나 통계 데이터 가공이 어려움
