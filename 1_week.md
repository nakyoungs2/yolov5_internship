# 머신러닝 분류 모델의 성능 평가 지표  


### 모델 성능 평가  
- 실제 값과 모델에 의해 예측된 값을 비교하여 두 값의 차이(오차)를 구하는 것
- 실제값 - 예측값 = 0이 되면 오차가 없는 것으로, 모델이 값을 100% 잘 맞웠다고 생각하면 된다.
- 하지만 예측값이 실제값과 100% 일치하는 것은 어렵기 때문에, 오차를 어느 정도가지 허용할지 결정하게 된다.  
- 모델 평가는 과적합(Overfitting)을 방지하고 최적의 모델을 찾기 위해서 실시한다.
- 결과변수(답안지)가 있어야 잘한건지 아닌지 확인할 수 있기 때문에 지도학습에서만 사용할 수 있다.
- 모델링의 목적 또는 목표 변수의 유형에 따라 다른 평가지표를 사용한다.
- Training과 Validation 값이 거의 일치해야 좋은 모델이다. 만약 Training 데이터로는 성능이 좋게 나왔는데 Validatin 데이터에서는 성능이 확연하게 떨어진다면 모델이 과적합된 상태이다.  

### 분류 모델 성능 평가  
- 하나의 목표를 가지고 여러 가지 분류 모델을 만드는 경우가 있는데, 그 중 어떤 모델이 가장 나을지 판단할 때 이러한 모델 평가 지표를 사용하게 된다.  
- 분류 모델의 평가 방법도 회귀 모형과 비슷하게, 실제 데이터와 예측 결과 데이터가 얼마나 서로 비슷한지에 기반하지만, 단순하게 이것만을 가지고 판단할 수는 없다.
- 분류 모델의 성능을 평가하기 위해 다음과 같은 지표를 활용한다.  
1. 정확도 (Accuracy)  
2. 오차 행렬 (Confusion Matrix)
3. 정밀도 (Precision)
4. 재현율 (Recall)
5. F1-score
6. ROC-AUC

3. 정밀도 (Precision)  
정밀도는 '양성으로 판단한 것 중, 진짜 양성의 비율'이다.
```
정밀도 = TP / TP + FP   
```

4. 재현율 (Recall) = 민감도 (Sensitivity)  
- '진짜 양성인 것들 중에서 올바르게 양성으로 판단한 비율'이다.  
- 양성 결과를 정확히 예측하는 능력으로, 모델의 완전성을 평가하는 지표로 사용된다.  
```
재현율 = TP / TP + FN
```

정밀도와 재현율은 Positive 데이터 세트의 예측 성능에 좀 더 초점을 맞춘 평가 지표이며, 이진 분류 모델의 업무 특성에 따라 특정 평가 지표가 더 중요한 지표로 간주될 수 있다.  
예를 들어 재현율은 실제 Positive(양성)인 데이터 예측을 Negative(음성)로 잘못 판단하게 되면 업무 상 큰 영향이 발생하는 경우 더 중요한 지표로 간주되고, 정밀도는 실제  Negative(음성)인 데이터를 Positive(양성)로 잘못 판단하게 되었을 때 큰 문제가 발생되는 경우 더 중요한 지표로 간주된다.

재현율과 정밀도 모두 TP(True Positive)를 높이는데 초점을 맞추지만, 재현율은 FN(실제 Positive한 것을 Negative로 예측)한 것을 낮추는데, 정밀도는 FP를 낮추는데 초점을 맞춘다.  
이와 같은 특성 때문에 재현율과 정밀도는 서로 보완적인 지표로 분류 성능을 평가하는데 사용되는데, 이때 어느 한쪽을 강제로 높이면 다른 하나의 수치는 떨어지기 쉬워진다.  
이를 정밀도와 재현율은 트레이트 오프(Trade-off)관계에 있다고 한다.

3. mAP  
합성곱 신경망 (Convolutional Neural Network CNN)의 모델 성능 평가는 대체로 mAP를 이용하여 평가한다.  
mAP를 이해하기 위해서는 먼저 IoU와 AP에 대해 이해해야 한다.  

3.1. IoU (Intersect over Union)  
객체 탐지 모델에서 "물체를 옳게 검출했다.", "물체가 옳게 검출되지 않았다."를 구분하는 기준을 의미한다.  
사용자가 인물의 위치에 적용한 바운더리 박스와 바운더리 박스가 주어지지 않은 상황에서 어떤 모델이 예측한 바운더리 박스라고 가정해보자.  
이때 모델이 설정한 바운더리 박스가 맞는지 틀린 지를 결정하기 위해서 나온 것이 IoU이다.  
![image](https://user-images.githubusercontent.com/120306359/224624163-6fc94510-1c0f-429b-a7cf-2a18dd6b9803.png)
